# CTF Writeup: NCL Spring 2023 Individual Game

## Challenge Name: AES (Hard) ! Unsolved

### Challenge Description:

Can you figure out what this code sample is doing?

```
section .text
global main
extern scanf

main:
  mov rax, 1
  mov rdi, 1
  mov rsi, message
  mov rdx, 28
  syscall

  push rax
  push rcx

  mov rdi, format
  mov rsi, buff

  call scanf

  pop rcx
  pop rax

  xor rbx, rbx
enc:
  mov rdx, buff
  add rdx, rbx
  mov byte al, [rdx]
  xor al, 0x27

  mov rdx, encbuff
  add rdx, rbx

  mov byte [rdx], al

  inc rbx
  cmp rbx, 13
  jne enc

  xor rbx, rbx
iseq:
  mov rdx, enctext
  add rdx, rbx
  mov byte al, [rdx]

  mov rdx, encbuff
  add rdx, rbx

  mov byte cl, [rdx]

  cmp al, cl
  jne end

  inc rbx
  cmp rbx, 13
  je win

  jmp iseq

win:
  mov rax, 1
  mov rdi, 1
  mov rsi, winmessage
  mov rdx, 8
  syscall

end:
  mov rax, 60
  xor rdi, rdi
  syscall

section .data
message: db `welcome to the ground floor\n`,27
format: db '%13s\n',6
enctext: db 074h, 06ch, 07eh, 0ah, 066h, 074h, 06ah, 065h, 0ah, 013h, 01fh, 015h, 01eh
winmessage: db `You win\n`,8

section .bss
buff: resb 14
encbuff: resb 14
```

### Challenge Questions:

1. What language is this written in?
2. What is the flag?


### Solution:



#### Step 1: Identify the format of the document information



#### Step 2: Use a decoder to decode the document information



#### Step 3: Provide answers to the challenge questions

#### Final Answer

1. Assembly
2. SKY-ASMB-4829


## Conclusion:

## Excerpts from Methodologies and techhniques used from NCL Discord
```
/* From the nasm assembly file.
 * For each byte in the enctext buffer (stored in AL register, a single byte), XOR it against 0x27

enc:
  mov rdx, buff
  add rdx, rbx
  mov byte al, [rdx]
  xor al, 0x27  ;   Each character is stored in AL register (1 byte), and XORed with 0x27

  mov rdx, encbuff
  add rdx, rbx

  mov byte [rdx], al

  inc rbx
  cmp rbx, 13   ; Counts to 13
  jne enc       ; Basically a for loop to keep XORing out the next characters until it gets to 13 characters long (the flag)

  xor rbx, rbx
iseq:
  mov rdx, enctext
  add rdx, rbx
  mov byte al, [rdx]

  mov rdx, encbuff
  add rdx, rbx

  mov byte cl, [rdx]

  cmp al, cl
  jne end

  inc rbx
  cmp rbx, 13
  je win

  jmp iseq


 * The ASM code will keep looping until its done and checks
 * SKY-ASMB-XXXX
 * */
 ```
 `I wrote a program in C, declared a array of unsigned characters of the hex characters, and XORed it by the key and printed it out on the screen`